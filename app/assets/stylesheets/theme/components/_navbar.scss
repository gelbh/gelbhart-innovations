@use "sass:map";

//
// Navbar
// --------------------------------------------------


// Brand

.navbar-brand {
  --#{$prefix}navbar-brand-padding-y: #{$navbar-brand-padding-y};
  --#{$prefix}navbar-brand-margin-end: #{$navbar-brand-margin-end};
  --#{$prefix}navbar-brand-font-size: #{$navbar-brand-font-size};
  --#{$prefix}navbar-brand-font-weight: #{$navbar-brand-font-weight};

  display: flex;
  align-items: center;
  padding: calc(var(--#{$prefix}navbar-brand-padding-y) * .5) 0;
  font-weight: var(--#{$prefix}navbar-brand-font-weight);
  > img {
    margin-right: .4375rem;
  }
}


// Menu toggler

.navbar-toggler {
  position: relative;
  width: $navbar-toggler-bar-width + $navbar-toggler-padding-x * 2;
  height: $navbar-toggler-bar-height * 3 + $navbar-toggler-bar-spacing * 2 + $navbar-toggler-padding-y * 2;
}

.navbar-toggler-icon {
  top: 50%;
  display: block;
  margin-top: $navbar-toggler-bar-height * -.5;
  transition-timing-function: cubic-bezier(.55, .055, .675, .19);
  transition-duration: .075s;

  &,
  &::before,
  &::after {
    position: absolute;
    width: $navbar-toggler-bar-width;
    height: $navbar-toggler-bar-height;
    background-color: var(--#{$prefix}navbar-toggler-color);
    transition-property: transform .15s ease;
  }

  &::before,
  &::after {
    display: block;
    content: "";
  }

  &::before {
    top: ($navbar-toggler-bar-spacing + $navbar-toggler-bar-height) * -1;
    transition: top .075s .12s ease, opacity .075s ease;
  }

  &::after {
    bottom: ($navbar-toggler-bar-spacing + $navbar-toggler-bar-height) * -1;
    transition: bottom .075s .12s ease, transform .075s cubic-bezier(.55, .055, .675, .19);
  }
}

[aria-expanded="true"] {
  .navbar-toggler-icon {
    transition-delay: .12s;
    transition-timing-function: cubic-bezier(.215, .61, .355, 1);
    transform: rotate(45deg);

    &::before {
      top: 0;
      opacity: 0;
      transition: top .075s ease, opacity .075s .12s ease;
    }

    &::after {
      bottom: 0;
      transition: bottom .075s ease, transform .075s .12s cubic-bezier(.215, .61, .355, 1);
      transform: rotate(-90deg);
    }
  }
}


// Navbar nav

.navbar-nav {
  --#{$prefix}nav-link-font-weight: #{$nav-link-font-weight};
  --#{$prefix}mega-dropdown-column-width: #{$mega-dropdown-column-width};
}


// Navbar dropdowns

.navbar .dropdown-toggle::after {
  margin-top: .0625rem;
  font-size: 1.15em;
}
.navbar .navbar-nav .dropdown-menu {
  background: none;
  border: 0;
  border-left: var(--#{$prefix}dropdown-border-wdth, 1px) solid var(--#{$prefix}border-color);
  @include border-radius(0);
  @include box-shadow(none);
  &.dropdown-menu-dark {
    border-color: $dropdown-dark-border-color;
  }
  .dropdown-menu {
    margin: {
      right: .75rem;
      left: .75rem;
    }
  }
  .dropdown-toggle::after {
    margin: {
      top: -.0625rem;
      right: 0;
      left: .125rem;
    }
    font-size: 1em;
  }
}

// Dropdown animation
@keyframes dropdown-show {
  from {
    opacity: 0;
    transform: scale(.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}


// Styles for expanded navbar only

.navbar-expand {
  @each $breakpoint in map.keys($grid-breakpoints) {
    $next: breakpoint-next($breakpoint, $grid-breakpoints);
    $infix: breakpoint-infix($next, $grid-breakpoints);

    &#{$infix} {
      @include media-breakpoint-up($next) {
        .navbar-brand { padding: var(--#{$prefix}navbar-brand-padding-y) 0; }
        .offcanvas {
          background-color: transparent !important; // stylelint-disable-line declaration-no-important
          @include box-shadow(none);
        }
        .offcanvas-header { display: none; }
        .dropdown-divider { display: block; }
        .navbar-nav .dropdown-menu {
          margin-top: var(--#{$prefix}dropdown-spacer);
          background-color: var(--#{$prefix}dropdown-bg);
          border: var(--#{$prefix}dropdown-border-width) solid var(--#{$prefix}dropdown-border-color);
          @include border-radius(var(--#{$prefix}dropdown-border-radius));
          @include box-shadow(var(--#{$prefix}dropdown-box-shadow));
          &.dropdown-menu-dark {
            background: var(--#{$prefix}dropdown-bg);
          }
        }
        .dropdown-menu.show { display: none; }
        .dropdown {
          &::before {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            height: $dropdown-spacer + .125rem;
            content: "";
          }
          .dropdown {
            .dropdown-toggle {
              display: flex;
              align-items: center;
              &::after {
                margin: {
                  top: 0;
                  right: -.3125rem;
                  left: auto;
                }
                font-size: 1.25em;
                content: "\ea50";
              }
            }
            .dropdown-menu {
              top: calc((var(--#{$prefix}dropdown-item-padding-y) + var(--#{$prefix}dropdown-padding-y)) * -1);
              left: 100%;
              margin: {
                right: 0;
                left: 0;
              }
            }
          }
          .dropdown-menu-end {
            right: 0;
            left: auto;
          }
        }
        .dropstart {
          > .dropdown-menu {
            top: calc((var(--#{$prefix}dropdown-item-padding-y) + var(--#{$prefix}dropdown-padding-y)) * -1);
            right: 94%;
            margin: {
              right: 0;
              left: 0;
            }
          }
        }
        .dropdown:hover > .dropdown-menu,
        .dropstart:hover > .dropdown-menu {
          display: block;
          animation: dropdown-show .2s;
        }
        .mega-dropdown-column {
          width: var(--#{$prefix}mega-dropdown-column-width);
          padding: 0 .75rem;
          &:last-child {
            border-right: 0;
          }
        }
      }
    }
  }
}


// Sticky navbar

.navbar-stuck {
  position: fixed !important; // stylelint-disable-line declaration-no-important
  top: 0;
  left: 0;
  z-index: $zindex-fixed + 1;
  width: 100%;
  animation: navbar-show .25s ease-in-out;
  @include box-shadow($box-shadow);
}

.navbar.position-absolute {
  top: 0;
  left: 0;
  z-index: $zindex-fixed;
  width: 100%;
}

@keyframes navbar-show {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}


// Navbar light (default)

.navbar {
  --#{$prefix}navbar-stuck-bg: #{$light};
  --#{$prefix}navbar-toggler-color: #{$navbar-light-toggler-bar-color};

  &.navbar-stuck {
    background-color: var(--#{$prefix}navbar-stuck-bg);
  }
  .nav-item {
    &:hover > .nav-link:not(.disabled) {
      color: var(--#{$prefix}navbar-hover-color);
    }
    &.active > .nav-link:not(.disabled) {
      color: var(--#{$prefix}navbar-active-color);
    }
  }
  .dropdown:hover > .nav-link {
    color: var(--#{$prefix}navbar-hover-color);
  }

  &.fixed-top {
    z-index: $zindex-fixed + 1;
  }
}


// Navbar dark

.navbar-dark {
  --#{$prefix}navbar-stuck-bg: #{$dark};
  --#{$prefix}navbar-toggler-color: #{$navbar-dark-toggler-bar-color};
}


// Dark color mode

@if $enable-dark-mode {
  @include color-mode(dark) {
    .navbar:not([data-bs-theme="light"]) {
      --#{$prefix}navbar-stuck-bg: #{$dark};
      --#{$prefix}navbar-brand-color: #{$navbar-dark-brand-color};
      --#{$prefix}navbar-brand-hover-color: #{$navbar-dark-brand-hover-color};
      --#{$prefix}navbar-toggler-color: #{$navbar-dark-toggler-bar-color};
      --#{$prefix}navbar-color: #{$navbar-dark-color};
      --#{$prefix}navbar-hover-color: #{$navbar-dark-hover-color};
      --#{$prefix}navbar-disabled-color: #{$navbar-dark-disabled-color};
      --#{$prefix}navbar-active-color: #{$navbar-dark-active-color};
    }
    .navbar-stuck:not([data-bs-theme="light"]) {
      box-shadow: none;
    }
  }
}


// Mobile menu modal
// --------------------------------------------------

.modal-content.mobile-menu-popup {
  border-radius: 1.5rem;
  overflow: hidden;
  animation: menu-popup 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  background-color: var(--#{$prefix}body-bg);
  border: 1px solid var(--#{$prefix}border-color);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15), 0 0 40px rgba(var(--#{$prefix}primary-rgb), 0.1);

  @if $enable-dark-mode {
    @include color-mode(dark) {
      background: linear-gradient(
        135deg,
        rgba(11, 15, 25, 0.98) 0%,
        rgba(30, 32, 40, 0.98) 100%
      );
      backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(99, 102, 241, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
  }
}

.modal-header {
  background: transparent;
  border-bottom: 1px solid var(--#{$prefix}border-color);
  padding: 1.5rem 1.5rem 1rem;

  @if $enable-dark-mode {
    @include color-mode(dark) {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
  }
}

.modal-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--#{$prefix}body-color);
  display: flex;
  align-items: center;

  @if $enable-dark-mode {
    @include color-mode(dark) {
      color: #fff;
    }
  }
}

.modal-body {
  padding: 1rem 1.5rem 1.5rem;
}

.btn-close {
  padding: 0.5rem;
  opacity: 0.8;
  transition: all 0.2s ease;

  &:hover {
    opacity: 1;
    transform: rotate(90deg) scale(1.1);
  }

  @if $enable-dark-mode {
    @include color-mode(dark) {
      filter: invert(1) grayscale(100%) brightness(200%);
    }
  }
}

.mobile-nav-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.mobile-nav-item {
  margin-bottom: 0.75rem;
}

.mobile-nav-link {
  display: flex;
  align-items: center;
  padding: 1rem 1.25rem;
  color: var(--#{$prefix}body-color);
  text-decoration: none;
  font-size: 1rem;
  font-weight: 500;
  border-radius: 0.75rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  cursor: pointer;
  user-select: none;
  background: rgba(var(--#{$prefix}body-color-rgb), 0.03);
  border: 1px solid transparent;
  touch-action: manipulation;
  min-height: 48px;
  margin-bottom: 0.5rem;

  @if $enable-dark-mode {
    @include color-mode(dark) {
      color: rgba(255, 255, 255, 0.85);
      background: rgba(255, 255, 255, 0.03);
    }
  }

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      background: rgba(var(--#{$prefix}primary-rgb), 0.1);
      color: var(--#{$prefix}primary);
      border-color: rgba(var(--#{$prefix}primary-rgb), 0.2);
      transform: translateX(4px);
      box-shadow: 0 4px 12px rgba(var(--#{$prefix}primary-rgb), 0.15);

      @if $enable-dark-mode {
        @include color-mode(dark) {
          background: linear-gradient(
            135deg,
            rgba(99, 102, 241, 0.2) 0%,
            rgba(124, 58, 237, 0.15) 100%
          );
          color: #fff;
          border-color: rgba(99, 102, 241, 0.3);
          box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }
      }
    }
  }

  &:active {
    background: rgba(var(--#{$prefix}primary-rgb), 0.15);
    color: var(--#{$prefix}primary);
    border-color: rgba(var(--#{$prefix}primary-rgb), 0.3);
    transform: translateX(2px) scale(0.98);
    box-shadow: 0 2px 8px rgba(var(--#{$prefix}primary-rgb), 0.2);

    @if $enable-dark-mode {
      @include color-mode(dark) {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.25) 0%,
          rgba(124, 58, 237, 0.2) 100%
        );
        color: #fff;
        border-color: rgba(99, 102, 241, 0.4);
        box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
      }
    }
  }

  &.active {
    background: rgba(var(--#{$prefix}primary-rgb), 0.1);
    color: var(--#{$prefix}primary);
    border-color: rgba(var(--#{$prefix}primary-rgb), 0.2);
    box-shadow: 0 4px 12px rgba(var(--#{$prefix}primary-rgb), 0.15);

    @if $enable-dark-mode {
      @include color-mode(dark) {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.2) 0%,
          rgba(124, 58, 237, 0.15) 100%
        );
        color: #fff;
        border-color: rgba(99, 102, 241, 0.3);
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
      }
    }

    &::before {
      content: "";
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 60%;
      background: var(--#{$prefix}primary);
      border-radius: 0 4px 4px 0;

      @if $enable-dark-mode {
        @include color-mode(dark) {
          background: linear-gradient(180deg, #6366f1 0%, #7c3aed 100%);
        }
      }
    }
  }

  &:focus-visible {
    outline: 2px solid var(--#{$prefix}primary);
    outline-offset: 2px;
  }

  i:first-child {
    font-size: 1.25rem;
    width: 1.5rem;
    opacity: 0.9;
    transition: all 0.3s ease;
  }

  &:hover i:first-child,
  &.active i:first-child {
    opacity: 1;
    color: var(--#{$prefix}primary);
    transform: scale(1.15) rotate(5deg);

    @if $enable-dark-mode {
      @include color-mode(dark) {
        color: #6366f1;
      }
    }
  }
}

.mobile-nav-chevron {
  font-size: 1.125rem;
  transition: transform 0.3s ease;
}

.mobile-nav-link[aria-expanded="true"]:not(:hover) .mobile-nav-chevron {
  transform: rotate(180deg);
}

.mobile-nav-link:hover:not([aria-expanded="true"]) .mobile-nav-chevron {
  transform: rotate(15deg) scale(1.1);
}

.mobile-nav-link[aria-expanded="true"]:hover .mobile-nav-chevron {
  transform: rotate(195deg) scale(1.1);
}

.mobile-nav-link[aria-expanded="true"] .mobile-nav-chevron {
  transform: rotate(180deg);
}

.mobile-nav-sublist {
  list-style: none;
  padding: 0.5rem 0 0 1.5rem;
  margin: 0.5rem 0 0;
  background: transparent;
  border: none;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  position: relative;
  border-left: 2px solid rgba(var(--#{$prefix}primary-rgb), 0.15);

  @if $enable-dark-mode {
    @include color-mode(dark) {
      border-left: 2px solid rgba(99, 102, 241, 0.15);
    }
  }

  &::before {
    content: "";
    position: absolute;
    left: -2px;
    top: 0.5rem;
    bottom: 0.5rem;
    width: 2px;
    background: linear-gradient(
      180deg,
      rgba(var(--#{$prefix}primary-rgb), 0.3) 0%,
      transparent 50%,
      rgba(var(--#{$prefix}primary-rgb), 0.1) 100%
    );
    border-radius: 2px;

    @if $enable-dark-mode {
      @include color-mode(dark) {
        background: linear-gradient(
          180deg,
          rgba(99, 102, 241, 0.3) 0%,
          transparent 50%,
          rgba(99, 102, 241, 0.1) 100%
        );
      }
    }
  }

  li {
    margin: 0;
  }
}

.mobile-nav-sublink {
  display: flex;
  align-items: center;
  padding: 0.875rem 1rem;
  color: var(--#{$prefix}body-color);
  text-decoration: none;
  font-size: 0.9375rem;
  font-weight: 400;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  cursor: pointer;
  border-radius: 0.625rem;
  margin: 0;
  background: rgba(var(--#{$prefix}body-color-rgb), 0.03);
  border: 1px solid var(--#{$prefix}border-color-translucent);
  touch-action: manipulation;
  min-height: 48px;

  @if $enable-dark-mode {
    @include color-mode(dark) {
      color: rgba(255, 255, 255, 0.75);
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      backdrop-filter: blur(8px);
    }
  }

  @media (hover: hover) and (pointer: fine) {
    &:hover {
      background: rgba(var(--#{$prefix}primary-rgb), 0.1);
      color: var(--#{$prefix}primary);
      border-color: rgba(var(--#{$prefix}primary-rgb), 0.2);
      box-shadow: 0 2px 8px rgba(var(--#{$prefix}primary-rgb), 0.15);

      @if $enable-dark-mode {
        @include color-mode(dark) {
          background: linear-gradient(
            135deg,
            rgba(99, 102, 241, 0.18) 0%,
            rgba(124, 58, 237, 0.12) 100%
          );
          color: rgba(255, 255, 255, 0.95);
          border-color: rgba(99, 102, 241, 0.3);
          box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);
        }
      }
    }
  }

  &:active {
    background: rgba(var(--#{$prefix}primary-rgb), 0.15);
    color: var(--#{$prefix}primary);
    border-color: rgba(var(--#{$prefix}primary-rgb), 0.3);
    transform: scale(0.98);
    box-shadow: 0 1px 6px rgba(var(--#{$prefix}primary-rgb), 0.2);

    @if $enable-dark-mode {
      @include color-mode(dark) {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.22) 0%,
          rgba(124, 58, 237, 0.16) 100%
        );
        color: rgba(255, 255, 255, 0.98);
        border-color: rgba(99, 102, 241, 0.35);
        box-shadow: 0 1px 6px rgba(99, 102, 241, 0.25);
      }
    }
  }

  &.active {
    background: rgba(var(--#{$prefix}primary-rgb), 0.1);
    color: var(--#{$prefix}primary);
    border-color: rgba(var(--#{$prefix}primary-rgb), 0.2);
    box-shadow: 0 2px 8px rgba(var(--#{$prefix}primary-rgb), 0.15);

    @if $enable-dark-mode {
      @include color-mode(dark) {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.18) 0%,
          rgba(124, 58, 237, 0.12) 100%
        );
        color: rgba(255, 255, 255, 0.95);
        border-color: rgba(99, 102, 241, 0.3);
        box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);
      }
    }

    &::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--#{$prefix}primary);
      border-radius: 0.625rem 0 0 0.625rem;

      @if $enable-dark-mode {
        @include color-mode(dark) {
          background: linear-gradient(180deg, #6366f1 0%, #7c3aed 100%);
        }
      }
    }
  }

  &:focus-visible {
    outline: 2px solid var(--#{$prefix}primary);
    outline-offset: 2px;
  }

  i {
    font-size: 1.125rem;
    width: 1.5rem;
    opacity: 0.8;
    transition: all 0.3s ease;
    margin-right: 0.75rem;
  }

  &:hover i,
  &.active i {
    opacity: 1;
    color: var(--#{$prefix}primary);
    transform: scale(1.15) rotate(5deg);

    @if $enable-dark-mode {
      @include color-mode(dark) {
        color: #6366f1;
      }
    }
  }
}

// Modal backdrop styling
.modal-backdrop.show {
  background-color: rgba(0, 0, 0, 0.5);

  @if $enable-dark-mode {
    @include color-mode(dark) {
      background-color: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(20px) saturate(180%);
    }
  }
}

// Popup animation
@keyframes menu-popup {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}
